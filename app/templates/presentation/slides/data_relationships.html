<article class="slide" data-slide-fragment>
  <header class="slide__header">
    <p class="eyebrow">Database</p>
    <h2 class="slide__title">Relationships between tables</h2>
    <p class="slide__lede">Tight foreign keys keep individuals, companies, accounts, journals, and trades stitched together.</p>
  </header>
  <div class="slide__content slide__grid">
    <div>
      <h3 class="slide__section-title">Money movement</h3>
      <ul class="slide__bullets">
        <li><code>party</code> → <code>account</code> → <code>journal_line</code> → <code>journal_entry</code>: who owns an account, how every entry is posted, and the channel/counterparty.</li>
        <li><code>journal_line</code> ↔ <code>category</code>/<code>section</code>: income vs expense vs transfer stays queryable for P&amp;L by party.</li>
        <li><code>account_party_role</code> reuses the same party ids so owner/manager/viewer permissions stay in sync with ledger balances.</li>
      </ul>
    </div>
    <div>
      <h3 class="slide__section-title">Investing graph</h3>
      <ul class="slide__bullets">
        <li><code>account</code> → <code>trade</code> → <code>lot</code> / <code>holding</code> ties fills to positions and cost basis.</li>
        <li><code>instrument</code> → <code>instrument_identifier</code> / <code>market</code> keeps symbols, ISINs, and venues normalized.</li>
        <li><code>price_quote</code> + <code>fx_rate_daily</code> provide valuation inputs; <code>position_agg</code> resolves to party-level unrealized P&amp;L.</li>
      </ul>
      <div class="slide__callout code-shell" aria-label="Join path for a payroll entry">
        <div class="code-block">
          <code>SELECT je.entry_code, p.display_name, a.account_type_code, jl.amount
FROM journal_entry je
JOIN journal_line jl   ON jl.entry_id = je.id
JOIN account a         ON a.id = jl.account_id
JOIN party p           ON p.id = a.party_id
WHERE je.entry_code = 'T-0000001';</code>
        </div>
      </div>
      <div class="slide__callout">
        <p class="slide__callout-title">Traceability example</p>
        <p>Pick <code>T-0000001</code>: entry lines point to account <code>A-U00128-CHK</code>, which belongs to individual <code>U-00128</code>; the counterparty points to company <code>C-00028</code>, giving the admin dashboard a full path.</p>
      </div>
    </div>
  </div>
</article>
