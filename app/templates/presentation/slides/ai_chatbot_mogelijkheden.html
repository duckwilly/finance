<article class="slide" data-slide-fragment>
  <header class="slide__header">
    <h2 class="slide__title">AI chatbot mogelijkheden</h2>
  </header>
  <div class="slide__content">
    <div style="margin-bottom: 1.5rem;">
      <h3 class="slide__section-title">Hoe het werkt</h3>
      <p>Wanneer een gebruiker een vraag stelt zoals "Toon mijn uitgaven per categorie":</p>
      <ol class="slide__bullets" style="list-style-type: decimal; padding-left: 1.5rem;">
        <li><strong>AI model:</strong> Genereert een plan met welke tools/data nodig zijn
          <ul style="margin-top: 0.25rem; padding-left: 1.25rem; list-style-type: disc;">
            <li>Ondersteunde LLMs: Claude (Anthropic) en GPT (OpenAI)</li>
            <li>Bestand: <code>app/ai_chatbot/llm_providers.py</code></li>
          </ul>
        </li>
        <li><strong>Python tools:</strong> Genereren SQL queries en halen data op uit de database
          <ul style="margin-top: 0.25rem; padding-left: 1.25rem; list-style-type: disc;">
            <li>Analytics functies zoals <code>expenses_by_category()</code>, <code>leaderboard()</code></li>
            <li>Bestand: <code>app/ai_chatbot/tools/analytics.py</code></li>
          </ul>
        </li>
        <li><strong>ChartGenerator:</strong> Python code zet de data om in Chart.js configuraties
          <ul style="margin-top: 0.25rem; padding-left: 1.25rem; list-style-type: disc;">
            <li>Genereert JSON configuraties voor bar, pie, line, doughnut charts</li>
            <li>Bestand: <code>app/ai_chatbot/chart_generator.py</code></li>
          </ul>
        </li>
        <li><strong>Frontend:</strong> Chart.js rendert de configuratie direct in de browser</li>
      </ol>
    </div>

    <div>
      <h3 class="slide__section-title">Automatische visualisaties</h3>
      <p>De Python ChartGenerator maakt Chart.js configuraties van database data. Bewerk de config hieronder en zie direct het resultaat:</p>
      
      <div style="margin: 1rem 0; display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <div>
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
            <label style="font-weight: 600;">Chart.js Config:</label>
            <button 
              onclick="renderDemoChart()"
              style="padding: 0.4rem 0.8rem; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.9rem;">
              â–¶ Render
            </button>
          </div>
          <div style="display: flex; gap: 0.5rem; margin-bottom: 0.5rem; flex-wrap: wrap;">
            <button onclick="loadTemplate('bar')" style="padding: 0.3rem 0.6rem; background: var(--presentation-surface-strong); border: 1px solid var(--presentation-border); border-radius: 4px; cursor: pointer; font-size: 0.8rem;">Bar Chart</button>
            <button onclick="loadTemplate('pie')" style="padding: 0.3rem 0.6rem; background: var(--presentation-surface-strong); border: 1px solid var(--presentation-border); border-radius: 4px; cursor: pointer; font-size: 0.8rem;">Pie Chart</button>
            <button onclick="loadTemplate('line')" style="padding: 0.3rem 0.6rem; background: var(--presentation-surface-strong); border: 1px solid var(--presentation-border); border-radius: 4px; cursor: pointer; font-size: 0.8rem;">Line Chart</button>
            <button onclick="loadTemplate('doughnut')" style="padding: 0.3rem 0.6rem; background: var(--presentation-surface-strong); border: 1px solid var(--presentation-border); border-radius: 4px; cursor: pointer; font-size: 0.8rem;">Doughnut</button>
            <button onclick="loadTemplate('radar')" style="padding: 0.3rem 0.6rem; background: var(--presentation-surface-strong); border: 1px solid var(--presentation-border); border-radius: 4px; cursor: pointer; font-size: 0.8rem;">Radar</button>
          </div>
          <textarea 
            id="chart-config-editor"
            style="width: 100%; min-height: 400px; padding: 0.75rem; border: 1px solid var(--presentation-border); border-radius: 8px; background: #1e1e1e; color: #d4d4d4; font-family: 'Courier New', monospace; font-size: 0.85rem; resize: vertical;"
            spellcheck="false">{
  "type": "bar",
  "data": {
    "labels": ["Jan", "Feb", "Mar", "Apr"],
    "datasets": [{
      "label": "Uitgaven",
      "data": [1000, 1200, 800, 1500],
      "backgroundColor": "rgba(95, 106, 252, 0.6)"
    }]
  },
  "options": {
    "responsive": true,
    "plugins": {
      "title": {
        "display": true,
        "text": "Uitgaven per maand"
      }
    }
  }
}</textarea>
        </div>
        <div>
          <label style="font-weight: 600; display: block; margin-bottom: 0.5rem;">Resultaat:</label>
          <div style="border: 1px solid var(--presentation-border); border-radius: 8px; padding: 1rem; background: var(--presentation-surface-strong); min-height: 400px; display: flex; align-items: center; justify-content: center;">
            <canvas id="demo-chart-canvas"></canvas>
          </div>
        </div>
      </div>
      <script>
        let demoChartInstance = null;
        
        const chartTemplates = {
          bar: {
            type: "bar",
            data: {
              labels: ["Jan", "Feb", "Mar", "Apr"],
              datasets: [{
                label: "Uitgaven",
                data: [1000, 1200, 800, 1500],
                backgroundColor: "rgba(95, 106, 252, 0.6)"
              }]
            },
            options: {
              responsive: true,
              plugins: {
                title: {
                  display: true,
                  text: "Uitgaven per maand"
                }
              }
            }
          },
          pie: {
            type: "pie",
            data: {
              labels: ["Huur", "Boodschappen", "Transport", "Entertainment"],
              datasets: [{
                data: [800, 400, 200, 100],
                backgroundColor: [
                  "rgba(95, 106, 252, 0.8)",
                  "rgba(96, 165, 250, 0.8)",
                  "rgba(139, 92, 246, 0.8)",
                  "rgba(244, 114, 182, 0.8)"
                ]
              }]
            },
            options: {
              responsive: true,
              plugins: {
                title: {
                  display: true,
                  text: "Uitgaven per categorie"
                }
              }
            }
          },
          line: {
            type: "line",
            data: {
              labels: ["Jan", "Feb", "Mar", "Apr", "Mei"],
              datasets: [{
                label: "Inkomsten",
                data: [2000, 2200, 1800, 2500, 2100],
                borderColor: "rgba(95, 106, 252, 1)",
                backgroundColor: "rgba(95, 106, 252, 0.1)",
                fill: true
              }, {
                label: "Uitgaven",
                data: [1500, 1600, 1400, 1800, 1500],
                borderColor: "rgba(244, 114, 182, 1)",
                backgroundColor: "rgba(244, 114, 182, 0.1)",
                fill: true
              }]
            },
            options: {
              responsive: true,
              plugins: {
                title: {
                  display: true,
                  text: "Inkomsten vs Uitgaven"
                }
              }
            }
          },
          doughnut: {
            type: "doughnut",
            data: {
              labels: ["Cash", "Aandelen", "Obligaties"],
              datasets: [{
                data: [50000, 30000, 20000],
                backgroundColor: [
                  "rgba(95, 106, 252, 0.8)",
                  "rgba(96, 165, 250, 0.8)",
                  "rgba(139, 92, 246, 0.8)"
                ]
              }]
            },
            options: {
              responsive: true,
              plugins: {
                title: {
                  display: true,
                  text: "Portfolio verdeling"
                }
              }
            }
          },
          radar: {
            type: "radar",
            data: {
              labels: ["Huur", "Boodschappen", "Transport", "Entertainment", "Zorg"],
              datasets: [{
                label: "Uitgaven",
                data: [800, 400, 200, 100, 300],
                backgroundColor: "rgba(95, 106, 252, 0.2)",
                borderColor: "rgba(95, 106, 252, 1)"
              }]
            },
            options: {
              responsive: true,
              plugins: {
                title: {
                  display: true,
                  text: "Uitgaven overzicht"
                }
              }
            }
          }
        };
        
        function loadTemplate(type) {
          const editor = document.getElementById('chart-config-editor');
          if (!editor || !chartTemplates[type]) return;
          
          editor.value = JSON.stringify(chartTemplates[type], null, 2);
          renderDemoChart();
        }
        
        function renderDemoChart() {
          const editor = document.getElementById('chart-config-editor');
          const canvas = document.getElementById('demo-chart-canvas');
          
          if (!editor || !canvas || !window.Chart) return;
          
          try {
            // Parse JSON from editor
            const config = JSON.parse(editor.value);
            
            // Destroy existing chart if it exists
            if (demoChartInstance) {
              demoChartInstance.destroy();
            }
            
            // Create new chart
            demoChartInstance = new Chart(canvas.getContext('2d'), config);
          } catch (e) {
            alert('Ongeldige JSON configuratie: ' + e.message);
            console.error('Error rendering chart:', e);
          }
        }
        
        // Auto-render on page load
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', renderDemoChart);
        } else {
          renderDemoChart();
        }
      </script>
    </div>
  </div>
</article>
